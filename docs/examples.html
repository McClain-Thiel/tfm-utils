<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; tfm_utils 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Docs" href="docs.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> tfm_utils
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tfm_utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="http://jaspar.genereg.net">JASPAR</a> is a very highly-touted transcription factor motif database from which motif count
matrices can be downloaded for a large variety of organisms and transcription factors. There exist numerous other motif
databases as well (TRANSFAC, CIS-BP, MEME, HOMER, WORMBASE, etc), most of which use a relatively similar format
for their motifs. Typically, a motif file consists of four rows or columns with each position in a given row or column corresponding
to a base within the motif. Sometimes there is an comment line started with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>. The row or column order is always <code class="docutils literal notranslate"><span class="pre">A,</span> <span class="pre">C,</span> <span class="pre">G,</span> <span class="pre">T</span></code>.
In this example, the motif consists of four rows corresponding to the 16 positions of the motif with counts for each base at each position.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; path = &quot;MA0007.1.pfm&quot;
&gt;&gt;&gt; ! cat MA0007.1.pfm
</pre></div>
</div>
<dl class="simple">
<dt>&gt;MA0007.1 Ar</dt><dd><p>9.00   9.00  11.00  16.00   0.00  12.00  21.00   0.00  15.00   4.00   5.00   6.00   3.00   0.00   4.00  11.00   1.00   3.00   6.00   6.00  10.00   5.00
7.00   2.00   3.00   1.00   0.00   6.00   2.00  24.00   0.00   9.00  11.00   9.00   5.00   0.00   0.00   5.00  22.00  16.00   7.00   5.00  11.00  11.00
2.00   3.00   3.00   7.00  22.00   1.00   0.00   0.00   8.00   2.00   2.00   9.00   1.00  24.00   0.00   1.00   1.00   1.00   5.00   9.00   0.00   6.00
6.00  10.00   7.00   0.00   2.00   5.00   1.00   0.00   1.00   9.00   6.00   0.00  15.00   0.00  20.00   7.00   0.00   4.00   6.00   4.00   3.00   2.00</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tfm_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">tfmp</span><span class="o">.</span><span class="n">create_matrix</span><span class="p">(</span><span class="s2">&quot;MA0045.pfm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tfmp</span><span class="o">.</span><span class="n">score2pval</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">8.7737</span><span class="p">)</span>
<span class="go">9.992625564336777e-06</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tfmp</span><span class="o">.</span><span class="n">pval2score</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="go">8.773708000000001</span>
</pre></div>
</div>
<p>This could also be done using pandas as follows</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tfm_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tests/M08490_1.94d.txt&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">            A         C         G         T</span>
<span class="go">Pos</span>
<span class="go">1    0.215492  0.220404  0.340647  0.223457</span>
<span class="go">2    0.534211  0.101312  0.330926  0.033551</span>
<span class="go">3    0.000000  0.000191  0.000286  0.999523</span>
<span class="go">4    0.014867  0.000000  0.756531  0.228601</span>
<span class="go">5    0.999333  0.000000  0.000000  0.000667</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">tfm_utils</span><span class="o">.</span><span class="n">df_to_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span>
<span class="go">&lt;tfm_utils.pytfmpval.Matrix; proxy of &lt;Swig Object of type &#39;Matrix *&#39; at 0x7fc2f8bfa330&gt; &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tfm_utils</span><span class="o">.</span><span class="n">score2pval</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="mf">7.14</span><span class="p">)</span>
<span class="go">3.516674041748047e-06</span>
</pre></div>
</div>
<p>This also works by passing the DataFrame into the functions directly and works for any orientation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">Pos        1         2         3         4         5         6        7    8         9    10        11        12</span>
<span class="go">A    0.215492  0.534211  0.000000  0.014867  0.999333  0.000000  0.03061  0.0  0.226232  1.0  0.035516  0.221931</span>
<span class="go">C    0.220404  0.101312  0.000191  0.000000  0.000000  0.968450  0.00000  0.0  0.758146  0.0  0.328779  0.327673</span>
<span class="go">G    0.340647  0.330926  0.000286  0.756531  0.000000  0.000508  0.96939  0.0  0.000000  0.0  0.101733  0.227845</span>
<span class="go">T    0.223457  0.033551  0.999523  0.228601  0.000667  0.031042  0.00000  1.0  0.015622  0.0  0.533973  0.222551</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tfm_utils</span><span class="o">.</span><span class="n">score2pval</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mf">7.14</span><span class="p">)</span>
<span class="go">5.960464477539063e-08</span>
</pre></div>
</div>
<p>If you are more used to R, this could also be done by creating a string for the matrix by concatenating the rows (or columns) and using the <code class="docutils literal notranslate"><span class="pre">read_matrix()</span></code> function.
This method is usually easier, as it allows the user to parse the motif file as necessary to ensure a proper input. It’s also more fitting for high-throughput use.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfm_utils</span> <span class="kn">import</span> <span class="n">tfmp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot; 3  7  9  3 11 11 11  3  4  3  8  8  9  9 11  2&quot;</span>
<span class="gp">... </span>       <span class="s2">&quot; 5  0  1  6  0  0  0  3  1  4  5  1  0  5  0  7&quot;</span>
<span class="gp">... </span>       <span class="s2">&quot; 4  3  1  4  3  2  2  2  8  6  1  4  2  0  3  0&quot;</span>
<span class="gp">... </span>       <span class="s2">&quot; 2  4  3  1  0  1  1  6  1  1  0  1  3  0  0  5&quot;</span>
<span class="gp">... </span>      <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">tfmp</span><span class="o">.</span><span class="n">read_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tfmp</span><span class="o">.</span><span class="n">pval2score</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="go">8.773708000000001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tfmp</span><span class="o">.</span><span class="n">score2pval</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">8.7737</span><span class="p">)</span>
<span class="go">9.992625564336777e-06</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="docs.html" class="btn btn-neutral float-right" title="Docs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, McClain Thiel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>